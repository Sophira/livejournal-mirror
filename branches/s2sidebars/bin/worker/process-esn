#!/usr/bin/perl
use strict;
use lib "$ENV{LJHOME}/cgi-bin";
require 'ljlib.pl';
require 'ljprotocol.pl';

use Getopt::Long;

my $interval = 5;
my $verbose  = 0;
usage() unless GetOptions('interval|n=i' => \$interval,
                          'verbose|v'    => \$verbose);

use LJ::Event;
use FindBin qw($Bin);

while (1) {
    my $now = time;
    print "[$$] \@$now: processing events...\n" if $verbose;
    LJ::Event->process_fired_events;
    sleep $interval;
}
