<section id="lj.install.ljconfig.vars">
  <title><literal>$LJ::</literal> Variables</title>
  <para>
    Each <literal>$LJ::</literal> variable is explained below.  There are two types: user-configurable ones and those that are automatically set and interesting only to people extending the LiveJournal code.
  </para>

  <section id='lj.install.ljconfig.vars.user'>
    <title>User-configurable</title>
    <para>
      New installations will probably want to set these variables.  Some are automatically set by <literal>ljdefaults.pl</literal> based on your other settings, but it wouldn't hurt to specify them all explicitly.
    </para>
    <variablelist>
      <title>Domain Related</title>

      <varlistentry>
        <term><literal role="variable">$LJ::SITENAME</literal></term>
        <listitem><para>The name of the site.  (example: "LiveJournal")</para></listitem>
      </varlistentry>

      <varlistentry>
        <term><literal role="variable">$LJ::SITEROOT</literal></term>
        <listitem><para>The URL prefix to construct canonical pages. This can include the port number, if 80 is not in use. (default: "http://www.$DOMAIN:8011")</para></listitem>
      </varlistentry>

      <varlistentry>
        <term><literal role="variable">$LJ::IMGPREFIX</literal></term>
        <listitem><para>The URL prefix of the image directory.  (default: "$SITEROOT/img")</para></listitem>
      </varlistentry>

      <varlistentry>
        <term><literal role="variable">$LJ::DOMAIN</literal></term>
        <listitem><para>The minimal domain of the site, excluding the "www." prefix if applicable. (example: "foo.com")</para></listitem>
      </varlistentry>

      <varlistentry>
        <term><literal
        role="variable">$LJ::DOMAIN_WEB</literal></term>
        <listitem><para>Optional.  If defined and different from
        <literal>$LJ::DOMAIN</literal>, any GET requests to
        <literal>$LJ::DOMAIN</literal> will be redirected to
        <literal>$LJ::DOMAIN_WEB</literal>.  (example:
        www.foo.com)</para></listitem>
      </varlistentry>

      <varlistentry>
        <term><literal role="variable">$LJ::COOKIE_DOMAIN</literal></term>
        <listitem><para>Cookie domains should simply be set to .$domain.com, based 
        on the Netscape Cookie Spec, but some older browsers don't adhere to the 
        specs too well. <literal>$LJ::COOKIE_DOMAIN</literal> can be a single string 
        value, or it can be a perl array ref like: 
        <programlisting>["", ".$DOMAIN"];</programlisting> (default: ".$DOMAIN")
        </para></listitem>
      </varlistentry>

      <varlistentry>
        <term><literal role="variable">$LJ::SERVER_NAME</literal></term>
        <listitem><para>Optional.  If using db-based web logging, this field is stored in the database in the server column, so you can see later how well each server performed.</para>
          <para>
            To share the same ljconfig.pl on each host (say, over NFS), you can put something like this in your <literal>ljconfig.pl</literal>:
            It's kinda ugly, but it works.
          </para>
          <programlisting>chomp($SERVER_NAME = `hostname`);</programlisting>
        </listitem>
      </varlistentry>

    </variablelist>
    <variablelist>
      <title>Database Related</title>

      <varlistentry>
        <term><literal role="variable">%LJ::DBINFO</literal></term>
        <listitem><para><literal role="variable">%LJ::DBINFO</literal> is a hash that contains the necessary information to connect to your database, as well as the configuration for multiple database clusters, if your installation supports them.
        See <xref linkend="lj.install.ljconfig.dbinfo" /> for more details.          
        </para></listitem>
      </varlistentry>

      <varlistentry>
        <term><literal role="variable">@LJ::CLUSTERS</literal></term>
        <listitem><para><literal role="variable">@LJ::CLUSTERS</literal> is an array that contains the names of the clusters that your configuration uses.
        (example: "qw(fast slow)")
        </para></listitem>
      </varlistentry>

      <varlistentry>
        <term><literal role="variable">$LJ::DEFAULT_CLUSTER</literal></term>
        <listitem><para>The default cluster to choose when creating new accounts.
        </para></listitem>
      </varlistentry>

      <varlistentry>
        <term><literal role="variable">$LJ::DIR_DB</literal></term>
        <listitem><para>
          Optional database that hosts the directory.
        </para></listitem>
      </varlistentry>

      <varlistentry id='ljconfig.var.dbinfo'>
        <term><literal role="variable">$LJ::DIR_DB_HOST</literal></term>
        <listitem><para>
          Specifies which host role the directory should use to connect to the database.
        </para></listitem>
      </varlistentry>

    </variablelist>
    <variablelist>
      <title>System Tools</title>

      <varlistentry>
        <term><literal role="variable">$LJ::SENDMAIL</literal></term>
        <listitem><para>
          The system path to the sendmail program, along with any necessary parameters. 
          (example: "/usr/sbin/sendmail -t")
        </para></listitem>
      </varlistentry>

      <varlistentry>
        <term><literal role="variable">$LJ::SPELLER</literal></term>
        <listitem><para>
          The system path to a spell checking binary, along with any necessary parameters. 
          (example: "/usr/local/bin/aspell pipe --sug-mode=fast --ignore-case")
        </para></listitem>
      </varlistentry>

    </variablelist>
  </section>
    
  <section id='lj.install.ljconfig.vars.auto'>
    <title>Auto-configured</title>
    <para>
      These <literal>$LJ::</literal> settings are automatically set in
      <literal>ljdefaults.pl</literal>.  They're only documented here
      for people interested in extending LiveJournal.  Or, you can define
      them in <literal>ljconfig.pl</literal> ahead of time so you can
      use them in definitions of future variables.
    </para>

    <variablelist>
      <varlistentry>
        <term><literal role="variable">$LJ::HOME</literal></term>
        <listitem><para><literal>ljdefaults.pl</literal> sets this to the same value as <literal>$ENV{'LJHOME'}</literal>.  You don't have to set it.</para></listitem>
      </varlistentry>

      <varlistentry>
        <term><literal role="variable">$LJ::HTDOCS</literal></term>
        <listitem><para>Also set by <literal>ljdefaults.pl</literal>, this points to the <literal>htdocs</literal> directory under <literal>$LJ::HOME</literal>.  You don't have to set it.</para></listitem>
      </varlistentry>

      <varlistentry>
        <term><literal role="variable">$LJ::BIN</literal></term>
        <listitem><para>Also set by <literal>ljdefaults.pl</literal>, this points to the <literal>bin</literal> directory under <literal>$LJ::HOME</literal>.  You don't have to set it.</para></listitem>
      </varlistentry>

    </variablelist>

  </section>

</section>
