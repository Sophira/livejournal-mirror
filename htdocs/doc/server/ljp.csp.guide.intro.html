<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta content="text/html; charset=ISO-8859-1" http-equiv="Content-Type"><title>1. Introduction to the Protocol</title><link rel="stylesheet" href="style.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.55.0"><link rel="home" href="index.html" title="LiveJournal Server"><link rel="up" href="ljp.csp.guide.html" title="Chapter 8. Client / Server Protocol - Quick Reference"><link rel="previous" href="ljp.csp.guide.html" title="Chapter 8. Client / Server Protocol - Quick Reference"><link rel="next" href="ljp.csp.guide.proxies.html" title="2. Working with Proxies"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">1. Introduction to the Protocol</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ljp.csp.guide.html">Prev</a> </td><th width="60%" align="center">Chapter 8. Client / Server Protocol - Quick Reference</th><td width="20%" align="right"> <a accesskey="n" href="ljp.csp.guide.proxies.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><h2 class="title" style="clear: both"><a class="linkhere" href="#ljp.csp.guide.intro">»</a><a name="ljp.csp.guide.intro"></a>1. Introduction to the Protocol</h2></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        Before reading this document, it is assumed you know at least some
        basics about network programming, at least the whole idea of opening
        sockets and reading/writing to them. If not, this might be kinda
        confusing.
      </p></div><p>Basically, sending a LiveJournal request is like this:</p><div class="procedure"><p class="title"><b>Procedure 8.1. Handshake</b></p><ol type="1"><li><p>Open a socket to www.livejournal.com on port 80</p></li><li><p>Send an HTTP POST request, containing the request variables (mode, user, password, etc...)</p></li><li><p>Read the socket to get the response. The response is really easy to parse.</p></li><li><p>Close the socket. Do any approriate action based on the server's response.</p></li></ol></div><p>For example, your client would output a request:
      </p><pre class="programlisting">
    
POST /interface/flat HTTP/1.0
Host: www.livejournal.com
Content-type: application/x-www-form-urlencoded
Content-length: 34

mode=login&amp;user=test&amp;password=test

      </pre><p>
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        All values must be quoted or the values can interfere with the encoding form. 
        For example, if someone's password was &#8216;blah&amp;=2+&amp;something=yeah&#8217;,
        it could quite possibly ruin the encoding format.
        Here are some guidelines on how to encode values:
        </p><div class="itemizedlist"><ul type="disc"><li><p>Leave all values from a-z, A-Z, and 0-9 alone. These are fine.</p></li><li><p>Convert spaces to a + (plus) sign.</p></li><li><p>Convert everything else to %<i><tt>hh</tt></i> where <i><tt>hh</tt></i> is the hex representation of the character's ASCII value.</p></li></ul></div><p>
      </p><p>
        For example, the phrase &#8216;I'm going to the mall&#8217; could encoded as &#8216;I%27m+going+to+the+mall&#8217;.
        There should be CGI libraries for all major languages which do this encoding for you.
        If not, it isn't that hard to do it yourself.
      </p></div><p>
      After you construct the big long ugly string of variables/values, find the length of
      it and send it in the Content-length field, as in the example above.
      Then send a blank line, then the big long ugly string.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Line Endings</h3><p>
        Please note that the end of lines should be a carriage return 
        (ASCII <tt>13</tt>, <tt>0x0D</tt>) and then a
        newline (ASCII <tt>10</tt>, <tt>0x0A</tt>).
        In Perl, C/C++ or Java this is &#8216;\r\n&#8217;. 
        In Basic, this is <tt>Chr(13)</tt> &amp; <tt>Chr(10)</tt>.
        Sending just the newline may work too, but it's generally better to send both.
      </p></div><p>A typical response would be:
      </p><pre class="programlisting">
    
HTTP/1.1 200 OK
Date: Sat, 23 Oct 1999 21:32:35 GMT
Server: Apache/1.3.4 (Unix)
Connection: close
Content-Type: text/plain

name
Mr. Test Account
success
OK
message
Hello Test Account!

      </pre><p>
    </p><p>
      The top stuff is headers from the HTTP request.
      There may be a lot of other stuff in there too. 
      First thing to do is make sure the first lines ends with &#8220;<tt>200 OK</tt>&#8221;.
      If the first line does not end with &#8220;<tt>200 OK</tt>&#8221;,
      tell the user that an error occurred on the server and that it's not their fault.
      If you see &#8220;<tt>200 OK</tt>&#8221; at the end, proceed with parsing the output.
      The format is as follows:
      </p><pre class="programlisting">
variable
value
someothervariable
someothervalue
      </pre><p>
      The ordering of the variable/value pairs does not matter.
      As you read them in, read them into a hash structure 
      (associative array, dictionary, collection&#8230;whatever it's called in your language. 
      Just a data structure that links one string variable key to another string variable value.).
    </p><p>
      After your hash is loaded, proceed with the logic of reporting errors if needed, as governed by the variables and logic above.
    </p></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ljp.csp.guide.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ljp.csp.guide.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ljp.csp.guide.proxies.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 8. Client / Server Protocol - Quick Reference </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 2. Working with Proxies</td></tr></table></div></body></html>
